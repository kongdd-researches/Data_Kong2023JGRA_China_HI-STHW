
# Data of "Contribution of Anthropogenic Activities to the Intensification of Heat Index-based Spatiotemporally Contiguous Heatwave Events in China"

> Kong et al., 2023, JGR-A

<!-- [![R-CMD-check](https://github.com/eco-hydro/phenofit/workflows/R-CMD-check/badge.svg)](https://github.com/eco-hydro/phenofit/actions)
[![codecov](https://codecov.io/gh/eco-hydro/phenofit/branch/master/graph/badge.svg)](https://app.codecov.io/gh/eco-hydro/phenofit) -->

[![License](http://img.shields.io/badge/license-GPL%20%28%3E=%202%29-brightgreen.svg?style=flat)](http://www.gnu.org/licenses/gpl-2.0.html)
[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.10360695.svg)](https://doi.org/10.5281/zenodo.10360695)

<!-- [![CRAN](http://www.r-pkg.org/badges/version/phenofit)](https://cran.r-project.org/package=phenofit)
[![total](https://cranlogs.r-pkg.org/badges/grand-total/phenofit)](https://cran.r-project.org/package=phenofit)
[![monthly](https://cranlogs.r-pkg.org/badges/phenofit)](https://cran.r-project.org/package=phenofit)
[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.5150204.svg)](https://doi.org/10.5281/zenodo.5150204) -->

# Data lists

## Figure 3

``` r
load("./dat_Figure2_annual_variation_STHW.rda")
print2(data_obs, data_sim, ts)
# List of 3
#  $ data_obs:Classes 'data.table' and 'data.frame':    1620 obs. of  5 variables:
#   ..$ model: chr [1:1620] "OBS" "OBS" "OBS" "OBS" ...
#   ..$ year : int [1:1620] 1961 1961 1961 1961 1961 1961 1962 1962 1962 1962 ...
#   ..$ prob : num [1:1620] 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 ...
#   ..$ index: Factor w/ 6 levels "\\(a\\) HWD",..: 1 2 3 4 5 6 1 2 3 4 ...
#   ..$ value: num [1:1620] 41 1.71 69.94 1.61 5.4 ...
#   ..- attr(*, ".internal.selfref")=<externalptr> 
#   ..- attr(*, "index")= int(0) 
#   .. ..- attr(*, "__prob")= int(0) 
#  $ data_sim:Classes 'data.table' and 'data.frame':    87480 obs. of  6 variables:
#   ..$ type_adj: Factor w/ 2 levels "adj","nonadj": 1 1 1 1 1 1 1 1 1 1 ...
#   ..$ model   : Factor w/ 27 levels "ACCESS-CM2","ACCESS-ESM1-5",..: 1 1 1 1 1 1 1 1 1 1 ...
#   ..$ year    : int [1:87480] 1961 1961 1961 1961 1961 1961 1962 1962 1962 1962 ...
#   ..$ prob    : num [1:87480] 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 ...
#   ..$ index   : Factor w/ 6 levels "\\(a\\) HWD",..: 1 2 3 4 5 6 1 2 3 4 ...
#   ..$ value   : num [1:87480] 12 1.26 15.17 2 3.7 ...
#   ..- attr(*, ".internal.selfref")=<externalptr> 
#  $ ts      :Classes 'data.table' and 'data.frame':    120 obs. of  7 variables:
#   ..$ type     : Factor w/ 2 levels "ALL","OBS": 1 1 1 1 1 1 1 1 1 1 ...
#   ..$ type_adj : Factor w/ 2 levels "adj","nonadj": 1 1 1 1 1 1 1 1 1 1 ...
#   ..$ prob     : num [1:120] 0.9 0.9 0.9 0.9 0.9 0.9 0.95 0.95 0.95 0.95 ...
#   ..$ index    : Factor w/ 6 levels "\\(a\\) HWD",..: 1 2 3 4 5 6 1 2 3 4 ...
#   ..$ label_reg: chr [1:120] "5.55 ± 2.25" "-0.01 ± 0.03" "9.02 ± 3.94" "0.10 ± 0.05" ...
#   ..$ label    : chr [1:120] "*slope* = 5.55 ± 2.25 day/decade, **" "*slope* = -0.01 ± 0.03 ℃/decade, -" "*slope* = 9.02 ± 3.94 ℃·day/decade, **" "*slope* = 0.10 ± 0.05 × 10^6 km^2/decade, **" ...
#   ..$ pcode    : chr [1:120] "**" "-" "**" "**" ...
#   ..- attr(*, ".internal.selfref")=<externalptr>
```

-   data_obs: observations (OBS)

-   data_sim: GCM simulations (SIM)

-   `ts`: trend of OBS and SIM

**Vairables**

-   `type_adj`: (1) adj: QDM bias-corrected; (2) nonadj: without QDM
-   `prob` : the threshold of HW definition, use 0.95 by default
-   `value` : values of HI-STHW characteristics

## Figure 4

``` r
load("./dat_Figure3_spatial_trend_STHW.rda")
str(df)
# Classes 'data.table' and 'data.frame':    41640 obs. of  7 variables:
#  $ type : Factor w/ 2 levels "OBS","ALL": 1 1 1 1 1 1 1 1 1 1 ...
#  $ prob : num  0.9 0.9 0.9 0.9 0.95 0.95 0.95 0.95 0.99 0.99 ...
#  $ index: Factor w/ 6 levels "HWD","HWI","HWS",..: 1 2 3 4 1 2 3 4 1 2 ...
#  $ lon  : num  121 121 121 121 121 ...
#  $ lat  : num  53.2 53.2 53.2 53.2 53.2 ...
#  $ slope: num  0.6522 0.0495 1.6708 0.1053 0.5 ...
#  $ mask : logi  TRUE TRUE TRUE TRUE TRUE TRUE ...
#  - attr(*, ".internal.selfref")=<externalptr>
```

**Variables: **

-   `type`: (1) OBS: observations; (2) ALL: CMIP6 ALL simulations

-   `mask`: (1) `TRUE`: trend is significant; (2) `FALSE`: trend is
    nonsignificant

## Figure 5

``` r
load("dat_Figure4_multiple_scenarios.rda")
print2(di_sim, ts)
# List of 2
#  $ di_sim:Classes 'data.table' and 'data.frame':  15876 obs. of  5 variables:
#   ..$ scenario: Factor w/ 4 levels "hist-aer","hist-GHG",..: 1 1 1 1 1 1 1 1 1 1 ...
#   ..$ model   : Factor w/ 27 levels "ACCESS-CM2","ACCESS-ESM1-5",..: 1 1 1 1 1 1 1 1 1 1 ...
#   ..$ year    : int [1:15876] 1961 1961 1961 1961 1961 1961 1962 1962 1962 1962 ...
#   ..$ index   : Factor w/ 6 levels "\\(a\\) HWD",..: 1 2 3 4 5 6 1 2 3 4 ...
#   ..$ value   : num [1:15876] 9 1.37 12.34 1.02 2.29 ...
#   ..- attr(*, ".internal.selfref")=<externalptr> 
#  $ ts    :Classes 'data.table' and 'data.frame':  24 obs. of  12 variables:
#   ..$ index    : chr [1:24] "\\(a\\) HWD" "\\(a\\) HWD" "\\(a\\) HWD" "\\(a\\) HWD" ...
#   ..$ scenario : Factor w/ 4 levels "hist-aer","hist-GHG",..: 1 2 3 4 1 2 3 4 1 2 ...
#   ..$ n        : int [1:24] 7 8 8 26 7 8 8 26 7 8 ...
#   ..$ mean     : num [1:24] -0.15095 16.86466 0.14379 3.14255 -0.00858 ...
#   ..$ median   : num [1:24] 0.00 1.55e+01 1.61e-01 3.12 7.99e-04 ...
#   ..$ sd       : num [1:24] 0.361 6.363 0.512 1.106 0.034 ...
#   ..$ ymin     : num [1:24] -0.3564 11.25 -0.0781 2.2764 -0.015 ...
#   ..$ ymax     : num [1:24] 0 22.575 0.5 3.806 0.0133 ...
#   ..$ pcode    : chr [1:24] "-" "**" "-" "**" ...
#   ..$ unit     : chr [1:24] "day/decade" "day/decade" "day/decade" "day/decade" ...
#   ..$ label_reg: chr [1:24] "-0.15 ± 0.36" "16.86 ± 6.36" "0.14 ± 0.51" "3.14 ± 1.11" ...
#   ..$ label    : chr [1:24] "*slope* = -0.15 ± 0.36 day/decade, -" "*slope* = 16.86 ± 6.36 day/decade, **" "*slope* = 0.14 ± 0.51 day/decade, -" "*slope* = 3.14 ± 1.11 day/decade, **" ...
#   ..- attr(*, ".internal.selfref")=<externalptr> 
#   ..- attr(*, "sorted")= chr "index"
```

-   `ts`: trends of different scenarios

## Figure 6

``` r
load("dat_Figure5_fingerprint_V5.rda")

print2(d_x, t_x, t_obs, d_noise_a, d_noise_b)
# List of 5
#  $ d_x      :Classes 'data.table' and 'data.frame':   66 obs. of  7 variables:
#   ..$ index: Factor w/ 6 levels "\\(a\\) HWD",..: 1 1 1 1 1 1 1 1 1 1 ...
#   ..$ x    : Factor w/ 11 levels "1","2","3","4",..: 1 2 3 4 5 6 7 8 9 10 ...
#   ..$ ALL  : num [1:66] -0.116 -0.135 -0.211 0.379 -0.411 ...
#   ..$ GHG  : num [1:66] -5.017 -4.342 -1.267 0.283 3.783 ...
#   ..$ AER  : num [1:66] 0.31 0.195 0.795 -0.862 -0.519 ...
#   ..$ NAT  : num [1:66] 0.0875 0.5375 0.2875 -0.4125 -0.6625 ...
#   ..$ OBS  : num [1:66] -0.333 0.667 -1.133 -0.333 0.467 ...
#   ..- attr(*, ".internal.selfref")=<externalptr> 
#   ..- attr(*, "sorted")= chr [1:2] "index" "x"
#  $ t_x      :Classes 'data.table' and 'data.frame':   30 obs. of  8 variables:
#   ..$ scenario: Factor w/ 5 levels "AER","GHG","NAT",..: 1 1 1 1 1 1 2 2 2 2 ...
#   ..$ index   : Factor w/ 6 levels "\\(a\\) HWD",..: 1 2 3 4 5 6 1 2 3 4 ...
#   ..$ n       : int [1:30] 7 7 7 7 7 7 8 8 8 8 ...
#   ..$ mean    : num [1:30] -0.00974 0.000313 -0.015968 -0.001223 -0.0028 ...
#   ..$ median  : num [1:30] 0 -0.000411 -0.012783 -0.001557 -0.003418 ...
#   ..$ sd      : num [1:30] 0.01788 0.00218 0.01808 0.00118 0.00261 ...
#   ..$ lower   : num [1:30] -0.03864 -0.00213 -0.03458 -0.00262 -0.0058 ...
#   ..$ upper   : num [1:30] 0 0.002731 0.008133 0.000379 0.000943 ...
#   ..- attr(*, ".internal.selfref")=<externalptr> 
#  $ t_obs    :Classes 'data.table' and 'data.frame':   6 obs. of  5 variables:
#   ..$ index: Factor w/ 6 levels "\\(a\\) HWD",..: 1 2 3 4 5 6
#   ..$ lower: num [1:6] 0.06897 0.00369 0.14624 0.00282 0.01544 ...
#   ..$ mean : num [1:6] 0.11111 0.00814 0.19237 0.00726 0.03056 ...
#   ..$ upper: num [1:6] 0.1538 0.014 0.2489 0.0144 0.0455 ...
#   ..$ sd   : num [1:6] 0.02625 0.00325 0.03188 0.00352 0.00901 ...
#   ..- attr(*, ".internal.selfref")=<externalptr> 
#  $ d_noise_a:Classes 'data.table' and 'data.frame':   522 obs. of  14 variables:
#   ..$ model: Factor w/ 23 levels "ACCESS-CM2","ACCESS-ESM1-5",..: 1 1 1 1 2 2 2 2 2 2 ...
#   ..$ chunk: int [1:522] 1 2 3 4 1 2 3 4 5 6 ...
#   ..$ index: Factor w/ 6 levels "\\(a\\) HWD",..: 1 1 1 1 1 1 1 1 1 1 ...
#   ..$ 1    : num [1:522] -1.33 3.33 7.07 1.5 4 ...
#   ..$ 2    : num [1:522] 0.0667 0.3333 -3.7333 -0.1 -1.2 ...
#   ..$ 3    : num [1:522] 1.667 2.333 -0.733 0.3 -0.4 ...
#   ..$ 4    : num [1:522] -1.133 -1.867 -0.333 -0.1 3.6 ...
#   ..$ 5    : num [1:522] -1.13 -1.47 -1.53 -0.3 -1.4 ...
#   ..$ 6    : num [1:522] 1.867 -2.667 -0.733 -1.3 -4.6 ...
#   ..$ 7    : num [1:522] -2.13 -1.07 1.07 4.1 -1.6 ...
#   ..$ 8    : num [1:522] -1.933 -1.067 0.467 1.1 -3.6 ...
#   ..$ 9    : num [1:522] -3.133 -0.867 1.267 -0.1 -3 ...
#   ..$ 10   : num [1:522] -1.53 -1.27 -2.93 -0.5 -3.2 ...
#   ..$ 11   : num [1:522] -1.53 -1.17 1.67 5.6 -2.3 ...
#   ..- attr(*, ".internal.selfref")=<externalptr> 
#  $ d_noise_b:Classes 'data.table' and 'data.frame':   522 obs. of  14 variables:
#   ..$ model: Factor w/ 23 levels "ACCESS-CM2","ACCESS-ESM1-5",..: 1 1 1 1 2 2 2 2 2 2 ...
#   ..$ chunk: int [1:522] 1 2 3 4 1 2 3 4 5 6 ...
#   ..$ index: Factor w/ 6 levels "\\(a\\) HWD",..: 1 1 1 1 1 1 1 1 1 1 ...
#   ..$ 1    : num [1:522] 0.333 -0.9 3.667 2.933 -1.967 ...
#   ..$ 2    : num [1:522] 0.733 -1.9 -0.133 0.533 0.433 ...
#   ..$ 3    : num [1:522] -1.867 2.7 -0.933 -0.867 -1.967 ...
#   ..$ 4    : num [1:522] -2.47 3.5 2.67 2.53 1.83 ...
#   ..$ 5    : num [1:522] 2.33 -2.3 -1.53 -1.07 -1.17 ...
#   ..$ 6    : num [1:522] 0.933 -1.1 -3.733 -4.067 2.833 ...
#   ..$ 7    : num [1:522] 2.333 -5.1 -0.733 1.933 0.633 ...
#   ..$ 8    : num [1:522] -0.267 -1.5 1.667 0.133 -2.167 ...
#   ..$ 9    : num [1:522] 0.933 0.1 -1.133 -2.067 0.233 ...
#   ..$ 10   : num [1:522] 1.1333 -0.5 0.4667 -0.0667 -1.7667 ...
#   ..$ 11   : num [1:522] 1.433 -4.8 -0.233 -4.267 5.283 ...
#   ..- attr(*, ".internal.selfref")=<externalptr>
```

-   `t_obs`: trends of the observed
-   `t_x`: trends of the CMIP6 simulated
-   `d_x`: the value of different signal
-   `d_noise_a`,`d_noise_b`: noise1 and noise2

## Figures 7 and 8

> Figures 6 and 7 share the same data.

``` r
load("dat_Figure6_HW_char_against_WarmingLevel.rda")
head(df_all)
# [data.table]: 
# # A data frame: 6 × 10
#   scenario type_adj model       year  prob index     value value_sm    HI HI_wl
#   <fct>    <fct>    <fct>      <int> <dbl> <chr>     <dbl>    <dbl> <dbl> <dbl>
# 1 ssp126   adj      ACCESS-CM2  1850   0.9 HWA_avg    2.64     2.26  13.6 0.103
# 2 ssp126   adj      ACCESS-CM2  1850   0.9 HWA_max    4.64     4.74  13.6 0.103
# 3 ssp126   adj      ACCESS-CM2  1850   0.9 HWA_sum  108.      69.8   13.6 0.103
# 4 ssp126   adj      ACCESS-CM2  1850   0.9 HWD       41       31     13.6 0.103
# 5 ssp126   adj      ACCESS-CM2  1850   0.9 HWI        2.05     1.64  13.6 0.103
# 6 ssp126   adj      ACCESS-CM2  1850   0.9 HWS_mean  84.1     51.2   13.6 0.103
```

-   `value_sm`: smoothed by a 21-year moving window
-   `HI_wl`: warming level

## Figure 9

``` r
df = fread("dat_Figure8_HW_char_in_Spatial.csv")
head(df)
# [data.table]: 
# # A data frame: 6 × 6
#   HI_wl  prob index value   lon   lat
#   <dbl> <dbl> <chr> <dbl> <dbl> <dbl>
# 1  0.85 0.9   HWD   55.3   121.  53.2
# 2  0.85 0.95  HWD   31.0   121.  53.2
# 3  0.85 0.99  HWD    9.00  121.  53.2
# 4  0.85 0.999 HWD    3.49  121.  53.2
# 5  0.85 1.00  HWD    3.06  121.  53.2
# 6  1.5  0.9   HWD   71.8   121.  53.2
```

# Acknowledgements

Keep in mind that this repository is released under a GPL2 license,
which permits commercial use but requires that the source code (of
derivatives) is always open even if hosted as a web service.
